<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Mission Complete! Test your knowledge with the final quiz">
    <meta name="theme-color" content="#e94560">
    <title>Mission Complete | CyberPuzzle.Fun</title>
    
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://code.jquery.com">
    
    <link rel="stylesheet" href="../style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>

<body>
    <div class="main_container">
        <header class="header">
            <div class="logo">
                <a href="../index.html" aria-label="Back to Home">
                    <img src="../puzzle1/assets/img/CyberPuzzle.Fun.png" alt="Logo" class="img-fluid">
                </a>
            </div>
            <div class="clearfix"></div>
        </header>

        <h1>üéâ Puzzle 1: Mission Accomplished!</h1>
        <section class="puzzle1">
            <div id="outerContainer">
                <div class="container">
                    <p class="typing">
                        WOO HOO! Yes! I have decoded the cipher text into plain text:
                        "MUKGEINEXTLOOKFORNORMORDERPICKLEPIE." <br>
                        Ummmm, what does that mean? Hrmmmm. I know - I'll put the spaces in between the words: <br>
                        "MUK GEI NEXT LOOK FOR NORM ORDER PICKLE PIE." <br>
                        OK - I see now - it's telling where to meet the contact, what his name is, the secret code I
                        should use to let him know that I'm a secret agent... <br>
                        I'll just put 2 + 2 together now and my mission here is done.
                    </p>

                    <div class="hiders" aria-hidden="true">
                        <p>&nbsp;</p>
                        <p>&nbsp;</p>
                        <p>&nbsp;</p>
                        <p>&nbsp;</p>
                        <p>&nbsp;</p>
                        <p>&nbsp;</p>
                        <p>&nbsp;</p>
                    </div>
                </div>
                <br><br><br><br><br><br><br>

                <div id="completion-card" style="
                    background: linear-gradient(135deg, rgba(40, 167, 69, 0.1) 0%, rgba(23, 162, 184, 0.1) 100%);
                    border: 2px solid #28a745;
                    border-radius: var(--border-radius);
                    padding: 30px;
                    max-width: 600px;
                    margin: 0 auto;
                    display: none;
                ">
                    <h2 style="color: #28a745; margin-bottom: 20px;">üèÜ Mission Statistics</h2>
                    <div id="mission-stats" style="text-align: left; color: var(--text-color);"></div>
                    <br>
                    <a href="./quiz.html" class="btn btn-primary" style="
                        display: inline-block;
                        background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
                        color: white;
                        padding: 15px 40px;
                        text-decoration: none;
                        border-radius: var(--border-radius);
                        font-weight: 600;
                        margin-top: 10px;
                    ">Take the Final Quiz ‚Üí</a>
                </div>

                <div id="quiz_div" style="margin-top: 30px;">
                    <div id="os-widget-1130687" class="os_widget" data-path="/rick-dobson/puzzle-1-final-quiz"
                        data-of="rick-dobson" data-opinionstage-widget="99d7ea60-ec69-4130-952b-4a4597c57eca"></div>
                </div>
            </div>
        </section>
    </div>
    
    <button class="skip-animation" onclick="skipAnimation()">‚è≠ Skip</button>
    
    <br>
    <footer>
        <div>
            <h3>Richard Dobson - USQ - U1011744</h3>
        </div>
    </footer>

    <div>
        <p id="copyright"><small>Copyright &copy; 2023. All Rights Reserved.</small></p>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js" 
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" 
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <script src="../puzzle1/dist/js/game-utils.js"></script>
    <script>
        // Opinion Stage widget loader
        (function (d, s, id, u) {
            if (d.getElementById(id)) return;
            var js,
                sjs = d.getElementsByTagName(s)[0],
                t = Math.floor(new Date().getTime() / 1000000);
            js = d.createElement(s);
            js.id = id;
            js.async = 1;
            js.src = u + "?" + t;
            sjs.parentNode.insertBefore(js, sjs);
        })(
            document,
            "script",
            "os-widget-jssdk",
            "https://www.opinionstage.com/assets/loader.js"
        );

        $(document).ready(function () {
            // Show completion card with reduced delay
            $("#completion-card").hide().delay(5000).fadeIn(1500);
            $("#quiz_div").hide().delay(8000).fadeIn(1500);
            
            // Display mission statistics
            displayMissionStats();
            
            // Mark puzzle as complete
            if (window.GameState) {
                GameState.saveProgress('puzzle1f');
            }
        });
        
        function displayMissionStats() {
            if (window.GameState) {
                const progress = GameState.getProgress();
                const statsDiv = document.getElementById('mission-stats');
                
                const completedSteps = Object.keys(progress).length;
                const steps = ['puzzle1', 'puzzle1b', 'puzzle1c', 'puzzle1d', 'puzzle1e', 'puzzle1f'];
                const stepNames = {
                    'puzzle1': 'Mission Briefing',
                    'puzzle1b': 'Cipher Identification',
                    'puzzle1c': 'Key Discovery',
                    'puzzle1d': 'Table Decryption',
                    'puzzle1e': 'Message Reading',
                    'puzzle1f': 'Mission Complete'
                };
                
                let html = '<ul style="list-style: none; padding: 0;">';
                steps.forEach(step => {
                    const completed = progress[step]?.completed;
                    const icon = completed ? '‚úì' : '‚óã';
                    const color = completed ? '#28a745' : '#666';
                    html += `<li style="margin: 10px 0; color: ${color};">${icon} ${stepNames[step]}</li>`;
                });
                html += '</ul>';
                
                statsDiv.innerHTML = html;
            }
        }
        
        function skipAnimation() {
            $(".hiders").hide();
            $("#completion-card, #quiz_div").stop(true, true).show();
            $(".skip-animation").hide();
        }
    </script>
</body>

</html>